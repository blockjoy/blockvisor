application_name = "sui"
node_type = "node"
version = "0.27.0-build.1"

[image]
debian_version = "focal"
rootfs_size = "10G"
fs_type = "ext4"
apt_image = ["libssl-dev","libpq-dev"]
apt_source = []
cmds = [
  "systemctl disable systemd-resolved.service",
  "rm /etc/dhcp/dhclient-enter-hooks.d/resolved",
  "rm /etc/resolv.conf",
  "echo 'nameserver 8.8.8.8' > /etc/resolv.conf",
  "echo 'nameserver 1.1.1.1' >> /etc/resolv.conf",
  "wget -O sui https://github.com/MystenLabs/sui/releases/download/devnet-0.27.0/sui",
  "wget -O sui-faucet https://github.com/MystenLabs/sui/releases/download/devnet-0.27.0/sui-faucet",
  "wget -O sui-node https://github.com/MystenLabs/sui/releases/download/devnet-0.27.0/sui-node",
  "wget -O sui-test-validator https://github.com/MystenLabs/sui/releases/download/devnet-0.27.0/sui-test-validator",
  "wget -O sui-tool https://github.com/MystenLabs/sui/releases/download/devnet-0.27.0/sui-tool", 
  "chmod +x sui sui-faucet sui-node sui-test-validator sui-tool",
  "mv sui /usr/bin/",
  "mv sui-faucet /usr/bin/",
  "mv sui-node /usr/bin/",
  "mv sui-test-validator /usr/bin/",
  "mv sui-tool /usr/bin/",
]

[build_machine]
apt_build_machine = []
git_repo = ""
git_tag = ""
build_cmds =  [
		"cp {{.YafimHome}}/babelsup/usr/bin/babelsup {{.YafimHome}}/target/sui/node/mnt/usr/bin/",
		"cp {{.YafimHome}}/babelsup/etc/systemd/system/babelsup.service {{.YafimHome}}/target/sui/node/mnt/etc/systemd/system/",
		"cp {{.YafimHome}}/babelsup/etc/systemd/system/multi-user.target.wants/babelsup.service {{.YafimHome}}/target/sui/node/mnt/etc/systemd/system/multi-user.target.wants/",
		"cp {{.YafimHome}}/blockvisor/babel_api/protocols/sui/node.toml {{.YafimHome}}/target/sui/node/mnt/etc/babel.conf",
		"echo 'root:f&IS_rwh' | chpasswd -R {{.YafimHome}}/target/sui/node/mnt",
		"echo sui > {{.YafimHome}}/target/sui/node/mnt/etc/hostname",
		"cp {{.YafimHome}}/blockvisor/babel_api/yafim/sui/supporting-files/fullnode.yaml {{.YafimHome}}/target/sui/node/mnt/blockjoy/sui"
]
